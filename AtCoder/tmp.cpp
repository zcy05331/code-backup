if (p != -1) dp[p][((((k >> i) << 1) | 1) << p) | (((1 << p) - 1) & k) | (1 << (j - (i - p) + 1))] += tmp;
if (q != -1) dp[q][(((k >> i) << 1) << q) | (((1 << q) - 1) & k) | (1 << (j - (i - q) + 1))] += tmp;